TESTGP#  CSECT
*MCALL #=     1 LV= 1          YREGS
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
*MEXIT #=     1 LV= 1 YREGS
         STM   R14,R12,12(R13)
         LR    R12,R15
         USING TESTGP#,R12
         LA    R2,SAVE
         ST    R13,4(,R2)
         ST    R2,8(,R13)
         LR    R13,R2
         LA    R1,SCREEN1
         LA    R0,SCREEN1L
*MCALL #=     2 LV= 1          TPUT  (1),(0),FULLSCR
*MCALL #=     3 LV= 2          ZOPTLR 1,1
*MEXIT #=     3 LV= 2 ZOPTLR
*MCALL #=     4 LV= 2          ZOPTLR 0,0
*MEXIT #=     4 LV= 2 ZOPTLR
         ICM   1,8,=B'00000011'
         SVC   93 R0=(ASID,LENGTH) R1=(FLAGS,ADDR)
*MEXIT #=     2 LV= 1 TPUT
*MCALL #=     5 LV= 1          TGET  INBUFF,INBUFFL,ASIS,WAIT
         LA    1,INBUFF
         LA    0,INBUFFL
         ICM   1,8,=B'10000001'
         SVC   93 R0=(ASID,LENGTH) R1=(FLAGS,ADDR)
*MEXIT #=     5 LV= 1 TGET
         UNPK  AIDSHOW(3),INBUFF(2)
         TR    AIDSHOW(2),HEX-C'0'
         MVI   AIDSHOW+2,C'<'
         LA    R1,SCREEN2
         LA    R0,SCREEN2L
*MCALL #=     6 LV= 1          TPUT  (1),(0),FULLSCR
*MCALL #=     7 LV= 2          ZOPTLR 1,1
*MEXIT #=     7 LV= 2 ZOPTLR
*MCALL #=     8 LV= 2          ZOPTLR 0,0
*MEXIT #=     8 LV= 2 ZOPTLR
         ICM   1,8,=B'00000011'
         SVC   93 R0=(ASID,LENGTH) R1=(FLAGS,ADDR)
*MEXIT #=     6 LV= 1 TPUT
*MCALL #=     9 LV= 1          STIMER WAIT,BINTVL=ENDWAIT
        IIHF  0,X'01010000' WAIT BINTVL
        LA    1,ENDWAIT
        SVC   X'2F' STIMER R0B0=TYPE,R0B1=INT, R0=EXIT, R1=INTVL ARG
*MEXIT #=     9 LV= 1 STIMER
         L     R13,4(,R13)
         LM    R14,R12,12(R13)
         SR    R15,R15
         BR    R14
SAVE     DC    18F'0'
ENDWAIT  DC    F'500'                GIVE 5 SECS TO EXAMINE SCREEN
* SCREEN1: WCC:SOUND_BELL+UNLOCK_KB+RESET_MDT
*          SBA TO LOCATION ZERO
*          REPEAT TO LOCATION ZERO X'5C'=EBCDIC ASTERISK
*          INSERT THE CURSOR (LEAVE IT AT TOP LEFT CORNER)
*          START FIELD LOW_INTENSITY+PROTECTED
*          (THIS SHOULD PUT ATTRIBUTE BYTE WHERE CURSOR WAS PUT)
SCREEN1  DC    X'C71140403C40405C131DF0'
SCREEN1L EQU   *-SCREEN1
* SCREEN2: WCC:SOUND_BELL+UNLOCK_KB+RESET_MDT
*          SBA TO LINE 10 COLUMN 20
*          DISPLAY 20 EBCDIC CHARACTERS STARTING THERE
*          NOTE: CURSOR IS NOT MOVED BY SCREEN2 DATA STREAM
SCREEN2  DC    X'C7114BE3'           4BE3 = LINE 10 COLUMN 20
         DC    C'>>>>INPUT-AID='
AIDSHOW  DC    C'??'
         DC    C'<<<<'
SCREEN2L EQU   *-SCREEN2
INBUFF   DC    XL80'00'
INBUFFL  EQU   *-INBUFF
HEX      DC    CL16'0123456789ABCDEF'
         END
